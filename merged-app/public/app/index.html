<!DOCTYPE html>
<html>
<head>

    <style>
        body {
            font-family: Lora, sans-serif;
        }
        .links {
            margin-top: 20px;
            text-align: center;
        }
        .dropdown-content-settings {
        display: none; /* Hide dropdown content by default */
        }
        drop-down[open] .dropdown-content {
            display: block; /* Show dropdown content when 'open' attribute is present */
        }
    </style>
    

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const response = await fetch('http://localhost:3000/api/sleep');
                if (!response.ok) {
                    throw new Error('Failed to fetch sleep data');
                }
                const data_raw = await response.json();
                const sleepData = data_raw.sleep[0];
                console.log('Sleep data:', sleepData);
                document.getElementById('score').textContent = sleepData.efficiency + " / 100";
                document.getElementById('date').textContent = sleepData.dateOfSleep;
            } catch (error) {
                console.error('Error fetching sleep data:', error);
            }
        });
    </script>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const toggleButton = document.querySelector('.dropbutton-settings');
            const dropdownContent = document.getElementById('dropdownLinks');
        
            toggleButton.addEventListener('click', () => {
                // Assuming the <drop-down> element toggles visibility based on an 'open' attribute
                const dropdown = document.getElementById('userDropdown');
                const isOpen = dropdown.hasAttribute('open');
                if (isOpen) {
                    dropdown.removeAttribute('open');
                    dropdownContent.style.display = 'none';
                } else {
                    dropdown.setAttribute('open', '');
                    dropdownContent.style.display = 'block';
                }
            });
        });
        document.addEventListener('DOMContentLoaded', () => {
        const isLightMode = localStorage.getItem('lightMode') === 'true';
        document.body.classList.toggle('light-mode', isLightMode);

        // If you're using a custom toggle-switch element on multiple pages,
        // you may also want to ensure it's in the correct state:
        const toggleSwitch = document.querySelector('toggle-switch');
        if (toggleSwitch) {
            toggleSwitch.setAttribute('on', isLightMode);
        }
});
    </script>

    <title>Sleep Score</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Handjet:wght@300&family=Sixtyfour&family=Workbench&display=swap" rel="stylesheet">
  <script type="module" crossorigin src="/assets/app-B8PL9Q55.js"></script>
  <link rel="stylesheet" crossorigin href="/assets/app-BUak3pWd.css">
</head>
<body>
    <button class="dropbutton-settings">
        <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGhlaWdodD0iNTEycHgiIGlkPSJMYXllcl8xIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MTIgNTEyOyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgNTEyIDUxMiIgd2lkdGg9IjUxMnB4IiB4bWw6c3BhY2U9InByZXNlcnZlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48cGF0aCBkPSJNNDI0LjUsMjE2LjVoLTE1LjJjLTEyLjQsMC0yMi44LTEwLjctMjIuOC0yMy40YzAtNi40LDIuNy0xMi4yLDcuNS0xNi41bDkuOC05LjZjOS43LTkuNiw5LjctMjUuMywwLTM0LjlsLTIyLjMtMjIuMSAgYy00LjQtNC40LTEwLjktNy0xNy41LTdjLTYuNiwwLTEzLDIuNi0xNy41LDdsLTkuNCw5LjRjLTQuNSw1LTEwLjUsNy43LTE3LDcuN2MtMTIuOCwwLTIzLjUtMTAuNC0yMy41LTIyLjdWODkuMSAgYzAtMTMuNS0xMC45LTI1LjEtMjQuNS0yNS4xaC0zMC40Yy0xMy42LDAtMjQuNCwxMS41LTI0LjQsMjUuMXYxNS4yYzAsMTIuMy0xMC43LDIyLjctMjMuNSwyMi43Yy02LjQsMC0xMi4zLTIuNy0xNi42LTcuNGwtOS43LTkuNiAgYy00LjQtNC41LTEwLjktNy0xNy41LTdzLTEzLDIuNi0xNy41LDdMMTEwLDEzMmMtOS42LDkuNi05LjYsMjUuMywwLDM0LjhsOS40LDkuNGM1LDQuNSw3LjgsMTAuNSw3LjgsMTYuOSAgYzAsMTIuOC0xMC40LDIzLjQtMjIuOCwyMy40SDg5LjJjLTEzLjcsMC0yNS4yLDEwLjctMjUuMiwyNC4zVjI1NnYxNS4yYzAsMTMuNSwxMS41LDI0LjMsMjUuMiwyNC4zaDE1LjIgIGMxMi40LDAsMjIuOCwxMC43LDIyLjgsMjMuNGMwLDYuNC0yLjgsMTIuNC03LjgsMTYuOWwtOS40LDkuM2MtOS42LDkuNi05LjYsMjUuMywwLDM0LjhsMjIuMywyMi4yYzQuNCw0LjUsMTAuOSw3LDE3LjUsNyAgYzYuNiwwLDEzLTIuNiwxNy41LTdsOS43LTkuNmM0LjItNC43LDEwLjItNy40LDE2LjYtNy40YzEyLjgsMCwyMy41LDEwLjQsMjMuNSwyMi43djE1LjJjMCwxMy41LDEwLjgsMjUuMSwyNC41LDI1LjFoMzAuNCAgYzEzLjYsMCwyNC40LTExLjUsMjQuNC0yNS4xdi0xNS4yYzAtMTIuMywxMC43LTIyLjcsMjMuNS0yMi43YzYuNCwwLDEyLjQsMi44LDE3LDcuN2w5LjQsOS40YzQuNSw0LjQsMTAuOSw3LDE3LjUsNyAgYzYuNiwwLDEzLTIuNiwxNy41LTdsMjIuMy0yMi4yYzkuNi05LjYsOS42LTI1LjMsMC0zNC45bC05LjgtOS42Yy00LjgtNC4zLTcuNS0xMC4yLTcuNS0xNi41YzAtMTIuOCwxMC40LTIzLjQsMjIuOC0yMy40aDE1LjIgIGMxMy42LDAsMjMuMy0xMC43LDIzLjMtMjQuM1YyNTZ2LTE1LjJDNDQ3LjgsMjI3LjIsNDM4LjEsMjE2LjUsNDI0LjUsMjE2LjV6IE0zMzYuOCwyNTZMMzM2LjgsMjU2YzAsNDQuMS0zNS43LDgwLTgwLDgwICBjLTQ0LjMsMC04MC0zNS45LTgwLTgwbDAsMGwwLDBjMC00NC4xLDM1LjctODAsODAtODBDMzAxLjEsMTc2LDMzNi44LDIxMS45LDMzNi44LDI1NkwzMzYuOCwyNTZ6Ii8+PC9zdmc+" alt="Menu" style="height:20px; width:20px; border-radius: 30px;">
    </button>
    <drop-down id="userDropdown" style="position: absolute; right: 0; width: max-content;">
        <div class="dropdown-content-settings" id="dropdownLinks" >
            <user-panel>
                <a href="profile_page">Profile Page</a><br>
            </user-panel>
        </div>
    </drop-down>
    
    <div class="metric">
        <div class="score-box">
            <h1>
                <svg class="icon">
                    <use href="/assets/sleep-CPtS16YK-CPtS16YK-CPtS16YK-CPtS16YK-CPtS16YK.svg#icon-sleeping" />
                </svg>
                Sleep Score
            </h1>
        </div>
        <table class="info-table"> <!-- Change this to a table -->
            <tr>
                <td class="label">Sleep Score:</td>
                <td class="value" id="score"></td>
            </tr>
            <tr>
                <td class="label">Date:</td>
                <td class="value" id="date"></td>
            </tr>
        </table>
    </div>
    <div class="sleep-cards-container">
        <sleep-card>
            <h2 slot="title"><a href="hours_asleep.html" >Hours Asleep</a></h2>
            <p slot="description">Track the total hours you've slept to understand your sleep patterns better.</p>
        </sleep-card>
        
        <sleep-card>
            <h2 slot="title"><a href="sleep_stages.html" >Sleep Stages</a></h2>
            <p slot="description">Review the stages of sleep you go through each night to improve sleep quality.</p>
        </sleep-card>
        
        <sleep-card>
            <h2 slot="title"><a href="spo2.html" >SpO2</a></h2>
            <p slot="description">Monitor your blood oxygen levels during sleep to identify potential health issues.</p>
        </sleep-card>
        
        <sleep-card>
            <h2 slot="title"><a href="interruptions.html" >Interruptions</a></h2>
            <p slot="description">Keep track of any interruptions in your sleep to find ways to sleep more soundly.</p>
        </sleep-card>
    </div>
</body>
</html>